<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Loupe Browser | Visium Data Preprocessing</title>
  <meta name="description" content="Online book ‘Visium Data Preprocessing’" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Loupe Browser | Visium Data Preprocessing" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Online book ‘Visium Data Preprocessing’" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Loupe Browser | Visium Data Preprocessing" />
  
  <meta name="twitter:description" content="Online book ‘Visium Data Preprocessing’" />
  



<meta name="date" content="2023-09-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="image-segmentation.html"/>
<link rel="next" href="space-ranger.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Visium Data Preprocessing</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#spatial-transcriptomics"><i class="fa fa-check"></i><b>1.1</b> Spatial transcriptomics</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#x-genomics-visium"><i class="fa fa-check"></i><b>1.2</b> 10x Genomics Visium</a></li>
</ul></li>
<li class="part"><span><b>II Visium data preprocessing</b></span></li>
<li class="chapter" data-level="2" data-path="visium-data-preprocessing.html"><a href="visium-data-preprocessing.html"><i class="fa fa-check"></i><b>2</b> Visium data preprocessing</a></li>
<li class="chapter" data-level="3" data-path="image-segmentation.html"><a href="image-segmentation.html"><i class="fa fa-check"></i><b>3</b> Image segmentation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="image-segmentation.html"><a href="image-segmentation.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="image-segmentation.html"><a href="image-segmentation.html#what-is-vistoseg"><i class="fa fa-check"></i><b>3.2</b> What is VistoSeg?</a></li>
<li class="chapter" data-level="3.3" data-path="image-segmentation.html"><a href="image-segmentation.html#split-histology-images"><i class="fa fa-check"></i><b>3.3</b> Split histology images</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="image-segmentation.html"><a href="image-segmentation.html#file-size-issues"><i class="fa fa-check"></i><b>3.3.1</b> File size issues</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="image-segmentation.html"><a href="image-segmentation.html#segment-cell-nuclei"><i class="fa fa-check"></i><b>3.4</b> Segment cell nuclei</a></li>
<li class="chapter" data-level="3.5" data-path="image-segmentation.html"><a href="image-segmentation.html#identify-number-of-cells-per-spot"><i class="fa fa-check"></i><b>3.5</b> Identify number of cells per spot</a></li>
<li class="chapter" data-level="3.6" data-path="image-segmentation.html"><a href="image-segmentation.html#wrapping-up"><i class="fa fa-check"></i><b>3.6</b> Wrapping up</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="loupe-browser.html"><a href="loupe-browser.html"><i class="fa fa-check"></i><b>4</b> Loupe Browser</a>
<ul>
<li class="chapter" data-level="4.1" data-path="loupe-browser.html"><a href="loupe-browser.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="loupe-browser.html"><a href="loupe-browser.html#manual-alignment-of-images"><i class="fa fa-check"></i><b>4.2</b> Manual alignment of images</a></li>
<li class="chapter" data-level="4.3" data-path="loupe-browser.html"><a href="loupe-browser.html#output-files-and-space-ranger"><i class="fa fa-check"></i><b>4.3</b> Output files and Space Ranger</a></li>
<li class="chapter" data-level="4.4" data-path="loupe-browser.html"><a href="loupe-browser.html#downstream-analyses-in-loupe-browser"><i class="fa fa-check"></i><b>4.4</b> Downstream analyses in Loupe Browser</a></li>
<li class="chapter" data-level="4.5" data-path="loupe-browser.html"><a href="loupe-browser.html#wrapping-up-1"><i class="fa fa-check"></i><b>4.5</b> Wrapping up</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="space-ranger.html"><a href="space-ranger.html"><i class="fa fa-check"></i><b>5</b> Space Ranger</a>
<ul>
<li class="chapter" data-level="5.1" data-path="space-ranger.html"><a href="space-ranger.html#overview-2"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="space-ranger.html"><a href="space-ranger.html#what-is-space-ranger"><i class="fa fa-check"></i><b>5.2</b> What is Space Ranger?</a></li>
<li class="chapter" data-level="5.3" data-path="space-ranger.html"><a href="space-ranger.html#installing-space-ranger"><i class="fa fa-check"></i><b>5.3</b> Installing Space Ranger</a></li>
<li class="chapter" data-level="5.4" data-path="space-ranger.html"><a href="space-ranger.html#run-spaceranger-count"><i class="fa fa-check"></i><b>5.4</b> Run spaceranger count</a></li>
<li class="chapter" data-level="5.5" data-path="space-ranger.html"><a href="space-ranger.html#output-files"><i class="fa fa-check"></i><b>5.5</b> Output files</a></li>
<li class="chapter" data-level="5.6" data-path="space-ranger.html"><a href="space-ranger.html#web-summary-.html-file"><i class="fa fa-check"></i><b>5.6</b> Web summary .html file</a></li>
<li class="chapter" data-level="5.7" data-path="space-ranger.html"><a href="space-ranger.html#import-outputs-into-r"><i class="fa fa-check"></i><b>5.7</b> Import outputs into R</a></li>
<li class="chapter" data-level="5.8" data-path="space-ranger.html"><a href="space-ranger.html#vistoseg-for-quantifying-cells-per-spot"><i class="fa fa-check"></i><b>5.8</b> VistoSeg for quantifying cells per spot</a></li>
<li class="chapter" data-level="5.9" data-path="space-ranger.html"><a href="space-ranger.html#wrapping-up-2"><i class="fa fa-check"></i><b>5.9</b> Wrapping up</a></li>
</ul></li>
<li class="part"><span><b>III Appendix</b></span></li>
<li class="chapter" data-level="6" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>6</b> Appendix</a>
<ul>
<li class="chapter" data-level="6.1" data-path="appendix.html"><a href="appendix.html#contributors"><i class="fa fa-check"></i><b>6.1</b> Contributors</a></li>
<li class="chapter" data-level="6.2" data-path="appendix.html"><a href="appendix.html#github-actions-workflow"><i class="fa fa-check"></i><b>6.2</b> GitHub Actions workflow</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Visium Data Preprocessing</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="loupe-browser" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Loupe Browser<a href="loupe-browser.html#loupe-browser" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="overview-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Overview<a href="loupe-browser.html#overview-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Loupe Browser is a desktop application from 10x Genomics that allows you to visualize your gene expression data without having to write code. You can utilize this software for most types of single cell transcriptomic data generated from 10x protocols, however we will discuss specifically how to use it for data generated from the Visium Spatial Gene Expression protocol. In general, you can use the Loupe Browser to align gene expression spots to histology images, look for marker gene expression, annotate populations, and cluster with three different clustering methods.</p>
<p><a href="https://support.10xgenomics.com/spatial-gene-expression/software/visualization/latest/analysis">Here</a> is a tutorial from 10x Genomics on how to use the Loupe Browser.</p>
</div>
<div id="manual-alignment-of-images" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Manual alignment of images<a href="loupe-browser.html#manual-alignment-of-images" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the crucial first steps for processing Visium data is to align the gene expression spots to a high resolution image of the tissue, which in some cases can be at 40x magnification. While Space Ranger can do this automatically, if you want to ensure a high quality alignment with no mistakes it is best to do this manually in the Loupe browser. First, you upload the image and enter the serial number for the slide.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="images/alignment_load_image.png" alt="Input your Visium Slide Serial Number and select your input image to start the alignment process using `Loupe` by 10x Genomics." width="100%" />
<p class="caption">
Figure 4.1: Input your Visium Slide Serial Number and select your input image to start the alignment process using <code>Loupe</code> by 10x Genomics.
</p>
</div>
<p>Then, you align the fiducial frame such that the red circles are visibly aligned with the fiducial frame pattern of spots.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="images/alignment_fiducial.png" alt="Visual alignment of the Visium fiducial frame to the bright field histology image using `Loupe` by 10x Genomics." width="100%" />
<p class="caption">
Figure 4.2: Visual alignment of the Visium fiducial frame to the bright field histology image using <code>Loupe</code> by 10x Genomics.
</p>
</div>
<p>Then, you manually select the spots that contain tissue by drawing a contour line. This information will be used later on to determine which spots overlap tissue and which do not, e.g. when creating a <code>SpatialExperiment</code> or other data object in R or Python.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="images/alignment_tissue.png" alt="Manual selection of the Visium spots that overlap tissue based on the selected alignemnt between the image and the Visium slide fiducial frame." width="100%" />
<p class="caption">
Figure 4.3: Manual selection of the Visium spots that overlap tissue based on the selected alignemnt between the image and the Visium slide fiducial frame.
</p>
</div>
</div>
<div id="output-files-and-space-ranger" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Output files and Space Ranger<a href="loupe-browser.html#output-files-and-space-ranger" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The output files from Space Ranger are detailed in the <a href="space-ranger.html#space-ranger">Space Ranger</a> chapter of this book. The <code>.cloupe</code> file is the one you need to import into the Loupe Browser in order to explore your processed data. These files are generally between 1 and 2 GB each.</p>
</div>
<div id="downstream-analyses-in-loupe-browser" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Downstream analyses in Loupe Browser<a href="loupe-browser.html#downstream-analyses-in-loupe-browser" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After running <a href="space-ranger.html#space-ranger">Space Ranger</a>, you can open the <code>.cloupe</code> file with <code>Loupe</code> and visually inspect the dimensionality reduction of the data through either a t-SNE or UMAP as well as apply graph-based or k-means clustering.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-13"></span>
<img src="images/tsne_kmeans.png" alt="Gene expression analysis results from `spaceranger count` visualized with `Loupe`." width="100%" />
<p class="caption">
Figure 4.4: Gene expression analysis results from <code>spaceranger count</code> visualized with <code>Loupe</code>.
</p>
</div>
<p>Most importantly you can overlay the gene expression data or annotated clusters onto the histology image. This can be done using R packages (e.g. from Bioconductor) or Python packages.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="images/spatial_graph_based.png" alt="Visual inspection of the graph-based clustering results from `spaceranger count` visualized with the tissue histology image in the background using `Loupe`." width="100%" />
<p class="caption">
Figure 4.5: Visual inspection of the graph-based clustering results from <code>spaceranger count</code> visualized with the tissue histology image in the background using <code>Loupe</code>.
</p>
</div>
<p><code>Loupe</code> has many features, including the ability to make genes lists and plot marker genes spatially.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="images/gene_expression.png" alt="Visualization with `Loupe` of four marker genes in the dorsolaterl prefrontal cortex (DLPFC): _SNAP25_ for neurons, _MBP_ for glia, _RELN_ for DLPFC layer 1 of the greay matter (neurons), and _PCP4_ for DLPFC layer 5. Only _PCP4_ is shown since this is the selected gene in our gene list." width="100%" />
<p class="caption">
Figure 4.6: Visualization with <code>Loupe</code> of four marker genes in the dorsolaterl prefrontal cortex (DLPFC): <em>SNAP25</em> for neurons, <em>MBP</em> for glia, <em>RELN</em> for DLPFC layer 1 of the greay matter (neurons), and <em>PCP4</em> for DLPFC layer 5. Only <em>PCP4</em> is shown since this is the selected gene in our gene list.
</p>
</div>
<p>You can also make violin plots to explore gene expression differences across spots grouped by some discrete variable, such as cluster membership.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="images/violin_plots.png" alt="_PCP4_ violin plots made with `Loupe` showing the log2 gene expression counts on the Y-axis." width="100%" />
<p class="caption">
Figure 4.7: <em>PCP4</em> violin plots made with <code>Loupe</code> showing the log2 gene expression counts on the Y-axis.
</p>
</div>
<p>Furthermore with <code>Loupe</code> you can look at differential expression statistic results for each gene across clusters.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="images/deg.png" alt="Differential gene expression statistics displayed by `Loupe`." width="100%" />
<p class="caption">
Figure 4.8: Differential gene expression statistics displayed by <code>Loupe</code>.
</p>
</div>
</div>
<div id="wrapping-up-1" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Wrapping up<a href="loupe-browser.html#wrapping-up-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>Loupe</code> can be particularly useful for annotating spots based on the clustering, dimension reduction, and known marker gene expression results from <code>spaceranger count</code>. That is, <code>Loupe</code> is a much more powerful interactive software than the <code>web_summary.html</code> file we will see in the <a href="space-ranger.html#space-ranger">Space Ranger</a> chapter.</p>
<p>While all these downstream analyses <code>Loupe</code> enables are the ones we are interested in doing, you might want to have more control in the choice of algorithms and parameters. Furthermore, you might want to analyze the data from multiple Visium capture tissue sections together, depending on the design of your Visium experiment. This can be done using R packages (e.g. from Bioconductor) or Python packages.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="image-segmentation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="space-ranger.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"lib_dir": "book_assets"
});
});
</script>

</body>

</html>
